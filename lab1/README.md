# Лабораторная работа: Создание и выполнение Shell-скриптов для автоматизации задач в Linux

## Выполнил

* Mihailov Piotr I2302
* Дата выполнения: 13.09.25

## Цель работы

Целью работы является изучение создания и выполнения простых Shell-скриптов для автоматизации рутинных задач в операционной системе Linux, а именно создание скрипта для резервного копирования директории.

## Задание

Создать Shell-скрипт для автоматизации задачи резервного копирования важной директории со следующими требованиями:

1. Скрипт должен называться `backup.sh`.
2. Скрипт должен принимать два аргумента: путь к директории для резервного копирования (обязательный) и путь к директории для сохранения резервной копии (необязательный, по умолчанию `/backup`).
3. Скрипт должен создавать архив `tar.gz` с текущей датой в имени файла (формат ГГГГ-ММ-ДД).
4. Скрипт должен проверять существование указанных директорий и выводить соответствующие сообщения об ошибках.

## Подготовка

Для выполнения работы необходимо:

1. Иметь доступ к терминалу в операционной системе Linux.
2. Убедиться, что утилита `tar` установлена (обычно предустановлена в большинстве дистрибутивов Linux).
3. Создать тестовую директорию с файлами для проверки работы скрипта.
4. Создать директорию для сохранения резервных копий (например, `/backup`).

## Выполнение работы

### 1. Создание скрипта `backup.sh`

Был создан Shell-скрипт `backup.sh` для выполнения задачи резервного копирования. Код скрипта приведен ниже:

```bash
#!/bin/bash

# Проверка, указан ли первый аргумент (директория для резервного копирования)
if [ -z "$1" ]; then
    echo "Ошибка: Не указан путь к директории для резервного копирования."
    echo "Использование: $0 <путь_к_директории> [путь_для_резервной_копии]"
    exit 1
fi

# Установка пути к директории для резервного копирования
source_dir="$1"

# Проверка, существует ли директория для резервного копирования
if [ ! -d "$source_dir" ]; then
    echo "Ошибка: Директория '$source_dir' не существует."
    exit 1
fi

# Установка пути для сохранения резервной копии (по умолчанию /backup)
backup_dir="${2:-/backup}"

# Проверка, существует ли директория для сохранения резервной копии
if [ ! -d "$backup_dir" ]; then
    echo "Ошибка: Директория для резервных копий '$backup_dir' не существует."
    exit 1
fi

# Получение текущей даты в формате ГГГГ-ММ-ДД
current_date=$(date +%Y-%m-%d)

# Формирование имени архива
backup_file="$backup_dir/backup_$current_date.tar.gz"

# Создание архива
tar -czf "$backup_file" "$source_dir"

# Проверка успешности создания архива
if [ $? -eq 0 ]; then
    echo "Резервная копия успешно создана: $backup_file"
else
    echo "Ошибка: Не удалось создать резервную копию."
    exit 1
fi
```

Скрипт был создан с помощью команды `touch backup.sh`, отредактирован в текстовом редакторе `nano`, и сделан исполняемым с помощью команды:

```bash
chmod +x backup.sh
```

### 2. Подготовка тестовой среды

Для тестирования была создана тестовая директория и директория для резервных копий:

```bash
mkdir -p ~/test_directory
echo "Тестовый файл" > ~/test_directory/test.txt
sudo mkdir -p /backup
```

### 3. Тестирование скрипта

Скрипт был протестирован в следующих сценариях:

#### Тест 1: Успешное создание резервной копии с директорией по умолчанию

```bash
./backup.sh ~/test_directory
```

**Вывод:**

![image](/images/test1.jpg)

**Проверка результата:**

```bash
ls /backup
```

![image](/images/test2.jpg)

#### Тест 2: Успешное создание резервной копии с указанной директорией

```bash
mkdir -p ~/my_backups
./backup.sh ~/test_directory ~/my_backups
```

**Вывод:**

![image](/images/test3.jpg)

**Проверка результата:**

```bash
ls ~/my_backups
```

Вывод:

![image](/images/test4.jpg)

#### Тест 3: Запуск без аргументов

```bash
./backup.sh
```

**Вывод:**

![image](/images/test5.jpg)

#### Тест 4: Указание несуществующей исходной директории

```bash
./backup.sh /nonexistent
```

**Вывод:**

![image](/images/test6.jpg)

#### Тест 5: Указание несуществующей целевой директории

```bash
./backup.sh ~/test_directory /nonexistent_backup
```

**Вывод:**

![image](/images/test7.jpg)

### 4. Проверка содержимого архива

Для проверки содержимого созданного архива была использована команда:

```bash
tar -tzf /backup/backup_2025-09-13.tar.gz
```

**Вывод:**

![image](/images/test8.jpg)

Это подтверждает, что архив содержит файлы из указанной директории.

## Выводы

В ходе выполнения лабораторной работы был создан и протестирован Shell-скрипт `backup.sh`, который автоматизирует процесс создания резервной копии директории. Скрипт успешно выполняет все требования задания: принимает обязательный и необязательный аргументы, создает архив `tar.gz` с текущей датой в имени файла, проверяет существование директорий и корректно обрабатывает ошибки. Тестирование подтвердило надежность и функциональность скрипта. Работа с Shell-скриптами позволяет эффективно автоматизировать рутинные задачи в Linux, упрощая управление системой.

## Библиография

* [GNU Tar Manual](https://www.gnu.org/software/tar/manual/) - Официальная документация по утилите `tar`, описывающая создание и управление архивами.  
* [Bash Scripting Tutorial](https://www.tldp.org/LDP/abs/html/) - Руководство по написанию Shell-скриптов на Bash, включая работу с аргументами и проверками условий.  
* [Linux Command Line and Shell Scripting Bible](https://www.wiley.com/en-us/Linux+Command+Line+and+Shell+Scripting+Bible%2C+4th+Edition-p-9781119700913) - Книга, описывающая основы написания Shell-скриптов для автоматизации задач в Linux
