#!/bin/bash

# Проверка, указан ли первый аргумент (директория для резервного копирования)
if [ -z "$1" ]; then
    echo "Ошибка: Не указан путь к директории для резервного копирования."
    echo "Использование: $0 <путь_к_директории> [путь_для_резервной_копии]"
    exit 1
fi

# Установка пути к директории для резервного копирования
source_dir="$1"

# Проверка, существует ли директория для резервного копирования
if [ ! -d "$source_dir" ]; then
    echo "Ошибка: Директория '$source_dir' не существует."
    exit 1
fi

# Установка пути для сохранения резервной копии (по умолчанию /backup)
backup_dir="${2:-/backup}"

# Проверка, существует ли директория для сохранения резервной копии
if [ ! -d "$backup_dir" ]; then
    echo "Ошибка: Директория для резервных копий '$backup_dir' не существует."
    exit 1
fi

# Получение текущей даты в формате ГГГГ-ММ-ДД
current_date=$(date +%Y-%m-%d)

# Формирование имени архива
backup_file="$backup_dir/backup_$current_date.tar.gz"

# Создание архива
tar -czf "$backup_file" "$source_dir"

# Проверка успешности создания архива
if [ $? -eq 0 ]; then
    echo "Резервная копия успешно создана: $backup_file"
else
    echo "Ошибка: Не удалось создать резервную копию."
    exit 1
fi